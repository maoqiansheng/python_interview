#索引
## 什么是索引
    索引是数据库管理系统的一个排序的数据结构，以协助快速查询，更新数据库中的数据
    索引是一种特殊的文件，（Innodb数据表中索引是表空间的一个组成部分），索引包含着对数据表中
    所有记录的位置信息。
    更通俗的说，数据库索引好比是一本书前面的目录，能加快数据库的查询速度.
## 索引的原理
    索引的实现通常使用B_TREE,B_TREE索引加速了数据的访问，存储引擎不会再去扫描整张表来得到想要的数据，
    相反，他从根节点开始，根节点保存了子节点的指针，储存引擎会根据指针快速寻找数据
    通过不断缩小查询数据的范围来得到想要的数据，同时把随机的事件变成有序的事件，使得我们可以通过
    同一种方式来锁定数据
## 索引的操作
    1、查看表中已经创建的索引
        show index from 表名;
---
    2、创建索引
        create index 索引名 on 表名(字段名(长度));
        注：如果该字段是字符串类型，需要指定长度，建议长度和定义字段时候的长度一致
            如果不是字符串类型，长度可以省略
---
    3、删除索引
    drop index 索引名 on 表名;
## 验证索引是否提高了性能
    set profiling=1;
    查询语句...
    show profiles;
    创建索引
    show profiles;
    
## 索引的好坏
    索引可以明显提高数据查询的效率
    索引太多会影响数据更新和插入的速度，因为同时需要对索引也进行更新，
    对于经常需要更新和插入的表，没有不要跟很少使用的where条件的字段建索引
    数据量比较小的表也没有必要建索引
    建索引会占用磁盘空间

## 索引为什么使用B+树
    为什么不使用平衡二叉树（AVL）?
    AVL深度比较深，访问一个树节点，都要对磁盘进行一次IO操作，浪费磁盘空间，消耗时间多
---
    为什么不使用红黑树？
    只有两路；不够平衡
---
    为什么不用B树？
    B+树是在B树的基础上做了改良，
    关键字数量和路数相等；
    B+Tree的根结点和枝叶节点都不会储存数据，只有叶子节点才会储存数据，这样做的好处是
    根结点和枝叶节点可以储存更多的指针
    InnoDB 中B+ 树深度一般为1-3 层，它就能满足千万级的数据存储。
    B+Tree 的每个叶子节点增加了一个指向相邻叶子节点的指针，它的最后一个数
    据会指向下一个叶子节点的第一个数据，形成了一个有序的双向链表的结构。
## 索引的使用原则
###1、列的离散度
    需要在列的离散度高的字段创建索引
    联合索引的最左匹配原则（经常查询的字段在建联合索引的时候需要把该字段放到左边）
###2、联合索引最左匹配
    建联合索引的时候应该最常用字段放到最左边，
###3、索引覆盖
    首先要知道回表的概念：
    回表：我们先通过非主键索引找到主键索引的键值，再根据主键值查出索引中没有的数据，
        它比基于主键索引的的查询多扫描了一棵索引树，这个过程叫做回表
    在辅助索引里，如果查询的数据只用索引就能取到，不用使用主键索引到数据区中去查找，这个
    时候使用的所以就是覆盖索引
    Extra 里面值为“Using index”代表使用了覆盖索引。
    覆盖索引减少了IO 次数，减少了数据的访问量，可以大大地提升查询效率
###4、索引条件下推（ICP）
    开启ICP
    set optimizer_switch='index_condition_pushdown=on';
    此时的执行计划，Using index condition
    注意，索引的比较是在存储引擎进行的，数据记录的比较，是在Server 层进行的。
## 索引创建的条件
    1、在where条件字段，order by 排序字段，join on 的字段
    2、索引的个数不要太多，浪费空间，更新变慢
    3、离散度低的字段，导致扫描行数过多，不需要建索引，例如性别
    4、频繁更新的字段不要作为主键和建索引
    5、联合索引把离散度高，经常查询的字段放到前面
## 索引失效的情况
    1、索引列上使用聚合函数，表达式，计算符号会导致索引失效
    2、字符串不加''，出现隐式转换
    3、like条件中'% '
    4、not like ,!=, not in ,<>
    
    
    
    
    
    
    

  